<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile</title>

    <!-- Links bootstrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <link rel="stylesheet" href="UserProfile.css" />
</head>

<body>

<div class="container py-5">
    <h1 class="text-center mb-4">My Profile</h1>
    <p class="required-note text-center mb-3">Fields marked with <span class="required-star">*</span> are required.</p>

    <!-- Completion progress bar, updated by javascript dynamically -->
    <div class="alert alert-completeness mb-4" id="completeness-banner">
        <strong>Profile Completeness: <span id="completeness-score">0%</span></strong>
        <div class="progress mt-2">
            <div class="progress-bar" id="completeness-bar" role="progressbar" style="width: 0%;"></div>
        </div>
    </div>

    <!-- Profile images and bio -->
    <div class="card mb-4">
        <div class="card-body">
            <h2 class="card-title">Profile Media & Bio</h2>
            <p class="text-muted">This forms your personal profile folder â€” photos, bio, and layout.</p>

            <!-- main profile picture -->

            <div class="mb-3">
                <label class="form-label">Profile Photo <span class="required-star">*</span></label>
                <div class="d-flex align-items-start gap-3">
                    <div class="flex-grow-1">
                        <input type="file" id="profile-photo" accept="image/*" class="form-control" onchange="previewProfilePhoto(event); updateCompleteness();">
                    </div>
                    <div id="profile-photo-preview-box" class="profile-photo-preview-box">
                        <img id="profile-photo-preview" src="" alt="" style="display:none;"> <!-- javascript swaps this value when a photo is selected -->
                        <span id="profile-photo-placeholder" class="text-muted">No photo</span>
                    </div>
                </div>
            </div>

            <!-- additional photos -->
            <div class="mb-3">
                <label for="additional-photos" class="form-label">Additional Photos</label>
                <input type="file" id="additional-photos" accept="image/*" multiple class="form-control" onchange="handleAdditionalPhotos(event)">
                <small class="text-muted">You can select multiple images at once.</small>
            </div>

            <!-- Preview for photos -->
            <div id="photo-preview-grid" class="row g-2 mb-3" style="display:none;">
                <!-- previews are inserted her by javascript -->
            </div>

            <div class="mb-3">
                <label for="bio" class="form-label">Bio <span class="required-star">*</span></label>
                <textarea id="bio" class="form-control" placeholder="Tell potential matches about yourself..." rows="5"></textarea>
            </div>
        </div>
    </div>

    <!-- Personal Details -->
    <div class="card mb-4">
        <div class="card-body">
            <h2 class="card-title">Personal Details</h2>

            <div class="mb-3">
                <label for="name" class="form-label">Name <span class="required-star">*</span></label>
                <input type="text" id="name" class="form-control" placeholder="Enter your name">
            </div>

            <div class="mb-3">
                <label for="age" class="form-label">Age <span class="required-star">*</span></label>
                <input type="number" id="age" class="form-control" placeholder="Enter your age" min="18" max="99"> <!-- 18+ site so 18 is the minimum age-->
            </div>

            <div class="mb-3">
                <label for="sex" class="form-label">Sex</label>
                <select id="sex" class="form-select">
                    <option value="">Select sex</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                    <option value="prefer-not">Prefer not to say</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="location" class="form-label">Location <span class="required-star">*</span></label>
                <input type="text" id="location" class="form-control" placeholder="Town / County / Region">
            </div>

            <div class="mb-3">
                <label class="form-label">Reputation Score</label>
                <input type="text" class="form-control" id="reputation_score" disabled placeholder="Calculated automatically">
                <small class="text-muted">Your reputation score is visible on your profile but cannot be manually set.</small>
            </div>

        </div>
    </div>


    <!-- Match Preferences -->
    <div class="card mb-4">
        <div class="card-body">
            <h2 class="card-title">Match Preferences</h2>
            <p class="text-muted">Tell us what you are looking for in a potential match.</p>

            <div class="mb-3">
                <label for="pref_age_min" class="form-label">Preferred Age Range</label>
                <div class="d-flex gap-2 align-items-center">
                    <input type="number" id="pref_age_min" class="form-control" placeholder="Min age" min="18" max="99">
                    <span>to</span>
                    <input type="number" id="pref_age_max" class="form-control" placeholder="Max age" min="18" max="99">
                </div>
            </div>

            <div class="mb-3">
                <label for="pref_sex" class="form-label">Preferred Sex</label>
                <select id="pref_sex" class="form-select">
                    <option value="">Select preference</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                    <option value="no-preference">No preference</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="pref_location" class="form-label">Preferred Location</label>
                <input type="text" id="pref_location" class="form-control" placeholder="Town / County / Region">
            </div>

            <div class="mb-3">
                <label for="user_preferred_type" class="form-label">I am looking for someone who is</label>
                <select id="user_preferred_type" class="form-select">
                    <option value="">Select preferred type</option>
                    <option value="all">All / No preference</option>
                    <option value="outdoors">Outdoors / Outgoing</option>
                    <option value="quiet">Quiet / Easygoing</option>
                    <option value="sporty">Sporty</option>
                    <option value="creative">Creative</option>
                    <option value="homebody">Homebody</option>
                </select>
            </div>

        </div>
    </div>

    <!-- User Interests Table Fields -->
    <div class="card mb-4">
        <div class="card-body">
            <h2 class="card-title">Interests & Type</h2>

            <div class="mb-3">
                <label for="user_type" class="form-label">I would describe myself as</label>
                <select id="user_type" class="form-select">
                    <option value="">Select your type</option>
                    <option value="sporty">Sporty</option>
                    <option value="gamer">Gamer</option>
                    <option value="adventurer">Adventurer</option>
                    <option value="homebody">Homebody</option>
                    <option value="creative">Creative</option>
                    <option value="other">Other</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="user_interest1" class="form-label">Top Interest</label>
                <input type="text" id="user_interest1" class="form-control" placeholder="e.g. Fishing">
            </div>

            <div class="mb-3">
                <label for="user_interest2" class="form-label">Second Interest</label>
                <input type="text" id="user_interest2" class="form-control" placeholder="e.g. Rock Climbing">
            </div>

            <div class="mb-3">
                <label for="user_interest3" class="form-label">Third Interest</label>
                <input type="text" id="user_interest3" class="form-control" placeholder="e.g. Gaming">
            </div>

        </div>
    </div>

    <!-- Incomplete error -->
    <div id="validation-error" class="alert alert-validation mb-3" style="display:none;"> <!-- Not visible until an invalid profile save attempt is made -->
        <strong>&#9888; Please fill in the following required fields before saving:</strong>
        <ul id="validation-list" class="mb-0 mt-1"></ul>
    </div>

    <!-- Save Button -->
    <div class="d-grid">
        <button class="btn btn-pink" onclick="saveProfile()">Save Profile</button>
    </div>

</div>

<!-- Loading the bootstrap javascript bundle from CDN -->
<!-- best to be place towards the end as page will load faster from perception of the user -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script src="UserProfile.js"></script>

</body>
</html>